<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡∏ß‡∏Å‡∏±‡∏ô</title>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background-color: #f0f4f8;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .container {
      max-width: 700px;
      width: 100%;
      padding: 20px;
    }

    h1, p {
      text-align: center;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 20px;
    }

    .form-grid-full {
      grid-column: span 2;
    }

    input, select, button {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
    }

    button {
      cursor: pointer;
      background-color: #1b7c2f;
      color: white;
      border: none;
      border-radius: 8px;
    }

    button:hover {
      background-color: #146324;
    }

    #message {
      margin: 20px 0;
      font-size: 18px;
      color: #333;
      text-align: center;
    }

    .faculty-group {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .faculty-group h3 {
      margin-top: 0;
    }

    .user-info {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin: 10px 0;
      text-align: left;
      background: #fafafa;
    }

    /* Modal styles */
    #apologyModal {
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.4);
      display: none;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      text-align: center;
      font-size: 16px;
      position: relative;
    }

    .modal-content h2 {
      margin-top: 0;
      font-size: 20px;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 16px;
      font-size: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏ô‡∏∞</h1>
    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠, Instagram, ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Åü´∂</p>

    <div class="form-grid">
      <input type="text" id="nameInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)">
      <input type="text" id="igInput" placeholder="Instagram (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà@)">
      <select id="campusSelect">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï --</option>
      </select>
      <select id="facultySelect">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞ --</option>
      </select>
      <input class="form-grid-full" type="text" id="messageInput" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å">
      <button id="checkButton">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
    </div>

    <div id="message"></div>
    <div id="allUsers"></div>
  </div>

  <!-- Modal apology -->
  <div id="apologyModal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>ü´∂ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©</h2>
      <p>‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏à‡∏£‡∏¥‡∏á‡πÜ‡∏ô‡∏∞ ‡πÅ‡∏Å‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£ ‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏™‡∏î.‡πÉ‡∏™‡πà‡πÅ‡∏Å ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ú‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏π‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πÉ‡∏´‡πâ‡∏≠‡∏†‡∏±‡∏¢ ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏à‡∏£‡∏¥‡∏á‡πÜ</p>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js';
    import { getDatabase, ref, set, get, child, update } from 'https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDZzrDMQiCR0sj3-zmsI1KAtLyc4A7waUw",
      authDomain: "introduce-a6132.firebaseapp.com",
      databaseURL: "https://introduce-a6132-default-rtdb.asia-southeast1.firebasedatabase.app/",
      projectId: "introduce-a6132",
      storageBucket: "introduce-a6132.appspot.com",
      messagingSenderId: "475532078463",
      appId: "1:475532078463:web:4e9d81323c608abed07e4a"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    const campusFaculties = {
      "‡∏ö‡∏≤‡∏á‡πÄ‡∏Ç‡∏ô": ["‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à", "‡∏õ‡∏£‡∏∞‡∏°‡∏á", "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ß‡∏ô‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡πå", "‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°", "‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏™‡∏´‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ", "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ö‡∏π‡∏£‡∏ì‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢", "‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏≤‡∏ô‡∏≤‡∏ä‡∏≤‡∏ï‡∏¥"],
      "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÅ‡∏™‡∏ô": ["‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏Å‡∏µ‡∏¨‡∏≤", "‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏™‡∏±‡∏ï‡∏ß‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£"],
      "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£": ["‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "‡∏®‡∏¥‡∏•‡∏õ‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£", "‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå"],
      "‡∏®‡∏£‡∏µ‡∏£‡∏≤‡∏ä‡∏≤": ["‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", "‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏®‡∏£‡∏µ‡∏£‡∏≤‡∏ä‡∏≤", "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏®‡∏£‡∏µ‡∏£‡∏≤‡∏ä‡∏≤", "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏®‡∏£‡∏µ‡∏£‡∏≤‡∏ä‡∏≤", "‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡∏ô‡∏≤‡∏ß‡∏µ‡∏ô‡∏≤‡∏ô‡∏≤‡∏ä‡∏≤‡∏ï‡∏¥"],
      "‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏™‡∏°‡∏ó‡∏ö": ["‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏•‡∏õ‡∏£‡∏∞‡∏ó‡∏≤‡∏ô"]
    };

    const campusSelect = document.getElementById("campusSelect");
    const facultySelect = document.getElementById("facultySelect");

    for (let campus in campusFaculties) {
      const option = document.createElement("option");
      option.value = campus;
      option.textContent = campus;
      campusSelect.appendChild(option);
    }

    campusSelect.addEventListener("change", () => {
      const selected = campusSelect.value;
      facultySelect.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞ --</option>';
      if (selected && campusFaculties[selected]) {
        campusFaculties[selected].forEach(faculty => {
          const option = document.createElement("option");
          option.value = faculty;
          option.textContent = faculty;
          facultySelect.appendChild(option);
        });
      }
    });

    function loadUsers() {
      const container = document.getElementById("allUsers");
      container.innerHTML = '';

      const usersRef = ref(database, 'users');
      get(usersRef).then(snapshot => {
        const users = snapshot.val() || {};
        const grouped = {};

        Object.values(users).forEach(user => {
          const faculty = user.faculty || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏";
          if (!grouped[faculty]) grouped[faculty] = [];
          grouped[faculty].push(user);
        });

        Object.keys(grouped).forEach(faculty => {
          const groupDiv = document.createElement('div');
          groupDiv.className = 'faculty-group';
          groupDiv.innerHTML = `<h3>‡∏Ñ‡∏ì‡∏∞: ${faculty}</h3>`;

          grouped[faculty].forEach(user => {
            const div = document.createElement('div');
            div.className = 'user-info';
            div.innerHTML = `
              <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${user.name}</p>
              <p><strong>IG:</strong> <a href="https://instagram.com/${user.ig}" target="_blank">@${user.ig}</a></p>
              <p><strong>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÄ‡∏Ç‡∏ï:</strong> ${user.campus || "-"}</p>
              <p><strong>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:</strong> ${user.message}</p>
            `;
            groupDiv.appendChild(div);
          });

          container.appendChild(groupDiv);
        });
      });
    }

    function checkName() {
  const name = document.getElementById("nameInput").value.trim();
  const ig = document.getElementById("igInput").value.trim();
  const campus = document.getElementById("campusSelect").value;
  const faculty = document.getElementById("facultySelect").value;
  const message = document.getElementById("messageInput").value.trim();
  const msgBox = document.getElementById("message");

  if (!name || !ig || !campus || !faculty || !message) {
    msgBox.innerHTML = "<p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>";
    return;
  }

  if (ig.toLowerCase() === "y3inana") {
    document.getElementById("apologyModal").style.display = "flex";
  }

  const userRef = ref(database, 'users');
  get(userRef).then(snapshot => {
    const users = snapshot.val() || {};
    const existingKey = Object.keys(users).find(key => users[key].name === name);
    const data = { name, ig, campus, faculty, message };

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
    const newUserRef = ref(database, 'users/' + Date.now());  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
    set(newUserRef, data);

    msgBox.innerHTML = `<p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏ô‡∏∞ ${name} üòä</p>`;

    loadUsers();
  });
}

    document.getElementById("checkButton").addEventListener("click", checkName);
    window.onload = loadUsers;

    // ‡∏õ‡∏¥‡∏î modal
    document.querySelector(".close-btn").addEventListener("click", () => {
      document.getElementById("apologyModal").style.display = "none";
    });
  </script>
</body>
</html>


